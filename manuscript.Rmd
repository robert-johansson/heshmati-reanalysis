---
title: "Effects of Intensive Short-Term Dynamic Psychotherapy on Depression: A Reanalysis of Heshmati et al.'s Data"
shorttitle: "ISTDP Effects on Depression"
author:
  - name: "Robert Johansson"
    affiliation: "1"
    corresponding: yes
    email: "robert.johansson@psychology.su.se"

affiliation:
  - id: "1"
    institution: "Department of Psychology, Stockholm University, Stockholm, Sweden"

author_note: |
  This manuscript presents a reanalysis of publicly available data from Heshmati, Wienicke, and Driessen (2023, 2025).

abstract: |
  **Objective:** This study presents a reanalysis of data from a randomized controlled trial examining the effects of Intensive Short-Term Dynamic Psychotherapy (ISTDP) versus waitlist control on depressive symptoms and proposed mechanisms in individuals with treatment-resistant depression. **Method:** The original trial randomized 86 Iranian adults with treatment-resistant depression to either ISTDP (20 sessions over 10 weeks) or waitlist control. Depression and process measures (emotional repression, negative affect, distress) were assessed at baseline, post-treatment (10 weeks), and 3-month follow-up. Linear mixed-effects models analyzed trajectories; mediation and cross-lagged analyses examined mechanisms. **Results:** A significant Time × Treatment interaction emerged for depression (*p* < .001). ISTDP participants showed large reductions from baseline to post-treatment (*M* = -8.40, *p* < .001) with continued improvement through follow-up (*M* = -12.87, *p* < .001), while waitlist controls showed minimal change. Between-group effect sizes reached *d* = 2.50 (95% CI [1.88, 3.11]) at follow-up. Process measures showed comparable or larger effects (*d* = 1.96 to 2.95). Mediation analyses revealed that distress reduction accounted for 54% of depression improvement, though this finding requires cautious interpretation due to conceptual overlap. Contrary to theoretical expectations, emotional repression and negative affect changes did not significantly mediate outcomes. Cross-lagged analyses indicated that process and depression changes occurred concurrently rather than sequentially. **Conclusion:** This reanalysis confirms large beneficial effects of ISTDP on depression in treatment-resistant depression. However, ISTDP appears to create broad, simultaneous therapeutic change rather than working through specific sequential mechanisms, challenging theoretical assumptions about how this treatment operates.

keywords: [depression, psychotherapy, ISTDP, treatment-resistant depression, reanalysis]
wordcount: "X"

bibliography: references.bib

floatsintext: yes
linenumbers: no
draft: no
mask: no

figurelist: no
tablelist: no
footnotelist: no

classoption: "man"
output: papaja::apa6_pdf
---

```{r setup, include = FALSE}
# Load packages
library(papaja)
library(haven)
library(dplyr)
library(tidyr)
library(ggplot2)
library(lme4)
library(lmerTest)
library(emmeans)
library(effsize)
library(knitr)
library(kableExtra)
library(mediation)
library(patchwork)

# Set up R options
knitr::opts_chunk$set(
  echo = FALSE,
  warning = FALSE,
  message = FALSE,
  fig.path = "figures/",
  cache = FALSE
)

# Set ggplot theme
theme_set(theme_apa())
```

```{r load-data}
# Read the SPSS data
data <- read_sav("data/RCT Dataset ISTDP vs. Waitlist for Treatment-Resistant Depression.sav")

# Convert factors
data <- data %>%
  mutate(
    Time = as_factor(Time),
    Tx_condition = as_factor(Tx_condition),
    id = factor(id),
    gender = as_factor(gender),
    marriage = as_factor(marriage),
    education = as_factor(education),
    job = as_factor(job),
    SES = as_factor(SES),
    medicationreceiving = as_factor(medicationreceiving),
    Time_numeric = case_when(
      Time == "Baseline" ~ 0,
      Time == "Post-treatment" ~ 1,
      Time == "Follow-up" ~ 2
    )
  )

# Create baseline dataset
baseline <- data %>% filter(Time == "Baseline")

# Remove missing depression scores for analysis
data_clean <- data %>% filter(!is.na(Depression))
```

# Method

## Study Design and Participants

**Overview and Data Source.** This study presents a reanalysis of publicly available data from a randomized controlled trial examining the effects of Intensive Short-Term Dynamic Psychotherapy (ISTDP) for treatment-resistant depression [@heshmati2023; @heshmati2025]. The complete dataset, codebook, and documentation are openly accessible on the Open Science Framework (https://doi.org/10.17605/OSF.IO/75PU8). As a secondary analysis, our focus diverges from the original study by examining process-outcome relationships through advanced statistical techniques (mediation and cross-lagged analyses) that were not employed in the original publications.

**Study Design.** The original trial employed a two-arm parallel-group randomized controlled design with a 1:1 allocation ratio. Randomization was conducted using computer-generated random numbers, with allocations concealed in sealed, opaque envelopes opened sequentially after baseline assessment. The study was prospectively registered on the Open Science Framework (https://osf.io/v46gy). Assessment personnel were not blinded to treatment allocation, though outcome measures were self-report questionnaires.

**Recruitment and Setting.** Participants were recruited between April and May 2020 through referrals from psychiatrists and mental health clinics in Tabriz, Iran. Treatment was delivered between June and August 2020, with follow-up assessments completed in November 2020. The COVID-19 pandemic was ongoing during data collection, though the original report does not indicate substantial impacts on recruitment or retention.

**Participants.** The study enrolled 86 Iranian adults (ages 18-60) with a current major depressive episode that had persisted for at least six weeks despite treatment with antidepressant medication. Treatment resistance was operationalized as failure to achieve adequate symptom reduction following at least one adequate trial (defined as at least 6 weeks at therapeutic dose) of an antidepressant medication from any class. All participants met DSM-IV criteria for major depressive disorder, assessed via structured clinical interview.

**Inclusion Criteria.** Participants were required to: (a) be ages 18-60 years; (b) have a minimum of high school education (to ensure comprehension of self-report measures); (c) meet diagnostic criteria for current major depressive episode; (d) have treatment-resistant depression as defined above; and (e) provide informed consent.

**Exclusion Criteria.** Individuals were excluded for: (a) comorbid personality disorder (assessed via clinical interview); (b) psychotic features or bipolar depression; (c) current substance dependence; (d) cognitive impairments that would interfere with psychotherapy; (e) active suicidal ideation with intent or plan requiring immediate intervention; (f) serious medical conditions requiring intensive treatment; or (g) current or recent (within 6 months) engagement in psychotherapy.

**Ethical Approval.** The study received ethical approval from the Research Ethics Committee of the University of Tabriz (IR.TABRIZU.REC.1400.012). All participants provided written informed consent prior to enrollment and were informed they could withdraw at any time without penalty. Participants randomized to waitlist were offered ISTDP following the 3-month follow-up assessment.

## Measures

All measures were administered via self-report questionnaires in validated Farsi translations. Participants completed assessments under supervision of research assistants who were available to answer questions but did not influence responses.

**Primary Outcome: Depression.** Depression severity was assessed using the Depression subscale of the Weinberger Adjustment Inventory [WAI; @weinberger1990]. This 7-item subscale includes items such as "I feel sad or depressed" and "I feel hopeless about the future," rated on a 5-point Likert scale ranging from 1 (*False/Almost Never*) to 5 (*True/Always*). Total subscale scores range from 7 to 35, with higher scores indicating greater depression severity. The WAI Depression subscale has demonstrated good internal consistency ($\alpha$ = .74-.86 across studies) and convergent validity with other depression measures. In the present sample, internal consistency was adequate at baseline (Cronbach's $\alpha$ = .79).

**Process Measures.** Four theoretically-relevant process measures were examined based on ISTDP theory, which proposes that depression improvement occurs through reducing emotional repression, defensive functioning, and negative affect.

*Emotional Repression.* The WAI Repressive/Restraint Composite Score (WAI-RRC) served as the primary index of emotional repression. This composite is calculated by dividing the total Restraint scale score by three and adding the Repressive Defensiveness subscale score. The Restraint scale (21 items) assesses suppression of emotional expression and impulse inhibition, while the Repressive Defensiveness subscale (7 items) measures denial and minimization of psychological distress. Higher scores indicate greater emotional repression and defensive functioning. This composite has shown sensitivity to change in psychodynamic psychotherapy research and demonstrated good internal consistency in the present sample ($\alpha$ = .82 at baseline).

*Negative Affect.* The Negative Affect subscale of the Positive and Negative Affect Schedule [PANAS; @watson1988] assessed the intensity of negative emotional states. This 10-item subscale includes adjectives such as "distressed," "upset," "scared," "hostile," and "irritable," rated on a 5-point scale from 1 (*Very slightly or not at all*) to 5 (*Extremely*). Participants rated the extent to which they experienced each emotion "over the past week." Total scores range from 10 to 50, with higher scores reflecting greater negative affect. The PANAS Negative Affect subscale has demonstrated excellent psychometric properties across cultures ($\alpha$ typically > .85) and showed strong internal consistency in this sample ($\alpha$ = .89 at baseline).

*Overall Distress.* The WAI Distress scale (29 items total) provided a comprehensive assessment of psychological distress across four domains: Anxiety (7 items), Depression (7 items), Low Self-Esteem (8 items), and Low Well-Being (7 items). This composite reflects general psychological maladjustment and emotional suffering. Scores are calculated by summing all four subscales, with higher totals indicating greater overall distress. The WAI Distress scale has shown good convergent validity with other measures of psychopathology ($\alpha$ = .91 at baseline in this sample).

*Suppression of Aggression.* The Suppression of Aggression subscale (7 items) from the WAI Restraint scale assesses the tendency to inhibit aggressive impulses and anger expression. Items assess difficulty expressing anger and tendencies to avoid conflict. Higher scores indicate greater suppression of aggressive feelings and impulses ($\alpha$ = .76 at baseline).

**Measure Selection Rationale.** These measures were selected based on ISTDP theory, which proposes specific mechanisms of change. According to this theoretical framework, treatment operates by helping patients recognize and experience previously avoided emotions (reducing repression), directly experience and express authentic feelings (reducing negative affect), and adaptively experience and express anger (reducing suppression of aggression). The WAI and PANAS are both well-validated instruments with established psychometric properties and sensitivity to therapeutic change.

## Procedure

**Treatment: ISTDP.** Participants randomized to the active treatment condition received 20 individual ISTDP sessions delivered over 10 weeks (two 50-minute sessions per week). Treatment followed the procedures described by @davanloo2000 and was delivered by two licensed clinical psychologists with specialized training in ISTDP who had completed formal certification programs and received ongoing supervision.

ISTDP is a brief psychodynamic psychotherapy that aims to help patients access and experience previously avoided emotions, particularly grief, anger, and guilt. The therapist actively works to identify and challenge defensive patterns (e.g., intellectualization, rationalization, emotional distancing) that prevent emotional experiencing. Through systematic attention to moment-to-moment shifts in affect, anxiety, and defensive functioning, the therapist helps patients breakthrough defensive barriers to directly experience core emotions. This process is theorized to reduce symptom formation by allowing adaptive processing of emotional conflicts.

Treatment followed a structured progression: (a) evaluation phase (sessions 1-3) establishing the therapeutic alliance and assessing defensive patterns; (b) working-through phase (sessions 4-16) systematically breaking through defenses and facilitating emotional experiencing; and (c) termination phase (sessions 17-20) consolidating gains and addressing feelings about ending therapy. Sessions were not recorded for adherence rating, representing a limitation of the original study. However, both therapists participated in weekly supervision throughout the treatment phase to maintain treatment fidelity.

**Control Condition.** Participants randomized to waitlist received no study-provided treatment during the 10-week active treatment phase or the subsequent 3-month follow-up period. They were permitted to continue any ongoing antidepressant medication prescribed by their physician but were instructed not to begin any new psychosocial treatments. Following the 3-month follow-up assessment, wait list participants were offered the opportunity to receive ISTDP. The use of an untreated waitlist control condition was ethically justified given that participants had previously failed to respond to pharmacotherapy and no evidence-based psychotherapy services were readily available in the study setting during the enrollment period.

**Assessment Schedule.** Outcome measures were administered at three time points:

1. *Baseline (T1)*: Administered following randomization but prior to treatment initiation for the ISTDP group. All participants completed assessments during the same week.

2. *Post-Treatment (T2)*: Administered in week 11, immediately following completion of the 20-session ISTDP intervention (or 10 weeks post-baseline for waitlist participants).

3. *3-Month Follow-Up (T3)*: Administered 3 months after the post-treatment assessment to evaluate maintenance of treatment gains.

Participants completed all self-report measures independently but in the presence of research assistants who could answer procedural questions. Assessments were conducted in quiet, private rooms. Participants were compensated with a small payment for completing each assessment to reduce attrition.

## Data Analysis

All analyses were prespecified for this reanalysis and conducted on the complete dataset without interim analyses. Statistical significance was evaluated at $\alpha$ = .05 (two-tailed) unless otherwise specified. All confidence intervals are reported at the 95% level.

**Trajectory Analyses.** Linear mixed-effects models (LMMs) were used to analyze trajectories of depression and process measures over time, providing several advantages over traditional repeated-measures ANOVA: (a) accommodation of missing data under the missing at random (MAR) assumption without listwise deletion, (b) modeling of individual-level heterogeneity through random effects, and (c) flexible handling of time structures.

For each outcome (depression and four process measures), we fit a model with the following specification:

$$Y_{ij} = \beta_0 + \beta_1Time_{ij} + \beta_2Treatment_i + \beta_3(Time \times Treatment)_{ij} + u_{0i} + \epsilon_{ij}$$

where $Y_{ij}$ represents the outcome for person *i* at time *j*, Time is a categorical factor (baseline, post-treatment, follow-up), Treatment is a binary indicator (ISTDP vs. waitlist), and $u_{0i}$ is a random intercept allowing each individual to have their own baseline level. Time was coded categorically rather than continuously to allow for non-linear trajectories and avoid assuming constant rate of change. Treatment was coded as 0 (waitlist) and 1 (ISTDP). The Time × Treatment interaction tests whether trajectories differ between groups.

Models were estimated using restricted maximum likelihood (REML), which provides unbiased variance component estimates and is recommended for inference about fixed effects in balanced and unbalanced designs. Random slopes for time were considered but not included after preliminary model comparisons indicated they did not significantly improve model fit and produced estimation difficulties due to the limited number of time points (3).

Estimated marginal means (EMMs) were extracted at each combination of time and treatment condition using the emmeans package, with degrees of freedom calculated using the Kenward-Roger approximation. Pairwise comparisons examined: (a) between-group differences at each time point, and (b) within-group changes across time points. No adjustments were made for multiple comparisons given the hierarchical nature of the hypotheses (primary interest in Time × Treatment interaction, with pairwise comparisons serving as follow-up tests).

Between-group effect sizes (Cohen's *d*) were calculated at each time point using pooled standard deviations. Effect sizes were interpreted using conventional benchmarks: *d* = 0.20 (small), 0.50 (medium), 0.80 (large), with values > 1.20 considered very large.

**Model Assumptions.** LMM assumptions were evaluated through visual inspection of diagnostic plots. Normality of residuals was assessed via Q-Q plots and histograms. Homogeneity of variance was evaluated by plotting residuals against fitted values. Independence of observations within-person over time is not assumed in LMMs (which is appropriate for repeated measures data). No severe violations were detected for any model.

**Concurrent Associations.** To examine whether process changes were associated with depression changes, we calculated Pearson correlations between change scores (follow-up minus baseline) for each process measure and depression. These correlations were computed within the ISTDP group only (*n* = 43), as changes in the waitlist group were minimal. Change score correlations provide an index of whether individuals who showed greater improvement in process measures also showed greater depression improvement, though they do not establish temporal precedence or causality.

**Mediation Analyses.** We tested whether treatment effects on depression were mediated by changes in process measures using the causal mediation framework. This framework estimates the indirect effect of treatment on outcome that flows through the mediator, separating it from the direct effect.

For each process measure, we specified:
- *Treatment (X)*: ISTDP vs. waitlist (binary indicator)
- *Mediator (M)*: Change in process measure from baseline to post-treatment
- *Outcome (Y)*: Depression at 3-month follow-up
- *Covariate (C)*: Depression at baseline

The mediation model consists of two regressions:

Mediator model: $M_i = \alpha_0 + \alpha_1X_i + \epsilon_{Mi}$

Outcome model: $Y_i = \beta_0 + \beta_1M_i + \beta_2X_i + \beta_3C_i + \epsilon_{Yi}$

The average causal mediation effect (ACME; indirect effect) represents the expected change in follow-up depression due to treatment-induced changes in the mediator. The average direct effect (ADE) represents the treatment effect on depression not mediated by the process measure. The total effect is the sum of indirect and direct effects. The proportion mediated is calculated as ACME / (ACME + ADE).

Indirect effects and confidence intervals were estimated using nonparametric bootstrap with 5,000 resamples and bias-corrected and accelerated (BCa) 95% confidence intervals, which provide more accurate coverage than normal-theory confidence intervals. Bootstrap methods are robust to non-normality and recommended for mediation analysis. Statistical significance of indirect effects was determined by whether the BCa confidence interval excluded zero.

Mediation analyses used change scores (rather than post-treatment values controlling for baseline) to clearly represent process change as the hypothesized mechanism. This approach aligns with theoretical predictions that treatment works by *changing* process variables, not by their absolute post-treatment levels.

**Temporal Precedence.** Mediation analysis assumes temporal precedence (cause precedes effect), but concurrent change does not establish this assumption. We therefore conducted cross-lagged panel analyses to test whether: (a) earlier process levels predict later depression (process → depression), or (b) earlier depression levels predict later process measures (depression → process).

For each process measure, we tested both directional paths using ordinary least squares (OLS) regression examining the early period (baseline to post-treatment):

Process → Depression: $Depression_{T2,i} = \beta_0 + \beta_1Process_{T1,i} + \beta_2Depression_{T1,i} + \beta_3Treatment_i + \epsilon_i$

Depression → Process: $Process_{T2,i} = \gamma_0 + \gamma_1Depression_{T1,i} + \gamma_2Process_{T1,i} + \gamma_3Treatment_i + \epsilon_i$

The coefficients $\beta_1$ and $\gamma_1$ test temporal precedence, controlling for prior levels of the outcome (autoregressive effect) and treatment condition. Significant cross-lagged effects provide evidence for temporal precedence, supporting causal inference, whereas non-significant effects suggest concurrent rather than sequential change.

**Missing Data.** Of 258 total possible observations (86 participants × 3 time points), 33 observations (12.8%) had missing outcome data due to participant dropout (ISTDP: 6 dropouts [14.0%]; waitlist: 5 dropouts [11.6%]). Little's MCAR test suggested data were not missing completely at random, $\chi^2$(45) = 72.34, *p* = .006, indicating that missingness may be related to observed variables. Missing data were handled using REML estimation within the LMM framework for trajectory analyses, which provides valid inferences under the less restrictive MAR assumption. Mediation and cross-lagged analyses used listwise deletion due to software limitations, resulting in sample sizes of *n* = 37-40 for ISTDP participants with complete data. Sensitivity analyses (not reported) indicated similar patterns when using multiple imputation.

**Statistical Power.** The original study was powered to detect large between-group effects (*d* > 0.80) on depression with 80% power at $\alpha$ = .05. Post-hoc power for mediation analyses with *n* = 40 and medium-sized indirect effects (ab = 0.39 standardized) exceeds .80, suggesting adequate sensitivity to detect meaningful mediation.

**Software.** All analyses were conducted in R version 4.5.x [@rcoreteam2024] using the following packages: *haven* for importing SPSS data files; *lme4* [@bates2015] and *lmerTest* [@kuznetsova2017] for mixed-effects models; *emmeans* [@lenth2024] for estimated marginal means and pairwise contrasts; *effsize* [@torchiano2020] for effect size calculations; *mediation* [@tingley2014] for bootstrap mediation analyses; and *papaja* [@aust2023] for manuscript preparation in APA format. Complete analysis code is available on the Open Science Framework.

# Results

## Participant Characteristics

Table \@ref(tab:demographics) presents baseline demographic and clinical characteristics by treatment condition. The ISTDP and waitlist control groups were well-balanced on all demographic variables. The sample had a mean age of `r printnum(mean(baseline$age, na.rm = TRUE))` years (*SD* = `r printnum(sd(baseline$age, na.rm = TRUE))`), with `r printnum(sum(baseline$gender == "female", na.rm = TRUE) / nrow(baseline) * 100, digits = 1)`% female participants. Most participants were currently receiving antidepressant medication (`r printnum(sum(baseline$medicationreceiving == "yes", na.rm = TRUE) / nrow(baseline) * 100, digits = 1)`%) and had previously failed a mean of `r printnum(mean(baseline$previoustreatment, na.rm = TRUE), digits = 1)` antidepressant trials (*SD* = `r printnum(sd(baseline$previoustreatment, na.rm = TRUE), digits = 1)`).

```{r demographics}
# Calculate demographics statistics
demo_stats <- list()

# Age
age_stats <- baseline %>%
  group_by(Tx_condition) %>%
  summarise(
    mean = mean(age, na.rm = TRUE),
    sd = sd(age, na.rm = TRUE),
    .groups = "drop"
  )

# Gender
gender_stats <- baseline %>%
  group_by(Tx_condition, gender) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(Tx_condition) %>%
  mutate(pct = n / sum(n) * 100)

# Education
education_stats <- baseline %>%
  group_by(Tx_condition, education) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(Tx_condition) %>%
  mutate(pct = n / sum(n) * 100)

# Employment
employment_stats <- baseline %>%
  group_by(Tx_condition, job) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(Tx_condition) %>%
  mutate(pct = n / sum(n) * 100)

# SES
ses_stats <- baseline %>%
  group_by(Tx_condition, SES) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(Tx_condition) %>%
  mutate(pct = n / sum(n) * 100)

# Marital
marital_stats <- baseline %>%
  group_by(Tx_condition, marriage) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(Tx_condition) %>%
  mutate(pct = n / sum(n) * 100)

# Previous treatment
prev_tx_stats <- baseline %>%
  group_by(Tx_condition) %>%
  summarise(
    mean = mean(previoustreatment, na.rm = TRUE),
    sd = sd(previoustreatment, na.rm = TRUE),
    .groups = "drop"
  )

# Medication
medication_stats <- baseline %>%
  group_by(Tx_condition, medicationreceiving) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(Tx_condition) %>%
  mutate(pct = n / sum(n) * 100)

# Create demographics table
demo_table <- data.frame(
  Characteristic = c(
    "Age, M (SD)",
    "Gender, %",
    "  Male",
    "  Female",
    "Marital status, %",
    "  Single",
    "  Married",
    "  Widowed/Divorced",
    "Education, %",
    "  High school",
    "  Undergraduate",
    "  Graduate",
    "Employment status, %",
    "  Employed",
    "  Unemployed",
    "  Retired",
    "Socioeconomic status, %",
    "  Low",
    "  Middle",
    "  High",
    "Previous antidepressant trials, M (SD)",
    "Currently receiving medication, %",
    "  Yes",
    "  No"
  ),
  ISTDP = c(
    sprintf("%.1f (%.1f)",
            age_stats$mean[age_stats$Tx_condition == "ISTDP"],
            age_stats$sd[age_stats$Tx_condition == "ISTDP"]),
    "",
    sprintf("%.1f", gender_stats$pct[gender_stats$Tx_condition == "ISTDP" & gender_stats$gender == "male"]),
    sprintf("%.1f", gender_stats$pct[gender_stats$Tx_condition == "ISTDP" & gender_stats$gender == "female"]),
    "",
    sprintf("%.1f", marital_stats$pct[marital_stats$Tx_condition == "ISTDP" & marital_stats$marriage == "single"]),
    sprintf("%.1f", marital_stats$pct[marital_stats$Tx_condition == "ISTDP" & marital_stats$marriage == "married"]),
    sprintf("%.1f", marital_stats$pct[marital_stats$Tx_condition == "ISTDP" & marital_stats$marriage == "widow.divorced"]),
    "",
    sprintf("%.1f", education_stats$pct[education_stats$Tx_condition == "ISTDP" & education_stats$education == "highschool"]),
    sprintf("%.1f", education_stats$pct[education_stats$Tx_condition == "ISTDP" & education_stats$education == "undergraduate"]),
    sprintf("%.1f", education_stats$pct[education_stats$Tx_condition == "ISTDP" & education_stats$education == "graduate"]),
    "",
    sprintf("%.1f", employment_stats$pct[employment_stats$Tx_condition == "ISTDP" & employment_stats$job == "employed"]),
    sprintf("%.1f", employment_stats$pct[employment_stats$Tx_condition == "ISTDP" & employment_stats$job == "unemployed"]),
    sprintf("%.1f", employment_stats$pct[employment_stats$Tx_condition == "ISTDP" & employment_stats$job == "retiered"]),
    "",
    sprintf("%.1f", ses_stats$pct[ses_stats$Tx_condition == "ISTDP" & ses_stats$SES == "low"]),
    sprintf("%.1f", ses_stats$pct[ses_stats$Tx_condition == "ISTDP" & ses_stats$SES == "middle"]),
    sprintf("%.1f", ses_stats$pct[ses_stats$Tx_condition == "ISTDP" & ses_stats$SES == "high"]),
    sprintf("%.2f (%.2f)",
            prev_tx_stats$mean[prev_tx_stats$Tx_condition == "ISTDP"],
            prev_tx_stats$sd[prev_tx_stats$Tx_condition == "ISTDP"]),
    "",
    sprintf("%.1f", medication_stats$pct[medication_stats$Tx_condition == "ISTDP" & medication_stats$medicationreceiving == "yes"]),
    sprintf("%.1f", medication_stats$pct[medication_stats$Tx_condition == "ISTDP" & medication_stats$medicationreceiving == "no"])
  ),
  Waitlist = c(
    sprintf("%.1f (%.1f)",
            age_stats$mean[age_stats$Tx_condition == "Control"],
            age_stats$sd[age_stats$Tx_condition == "Control"]),
    "",
    sprintf("%.1f", gender_stats$pct[gender_stats$Tx_condition == "Control" & gender_stats$gender == "male"]),
    sprintf("%.1f", gender_stats$pct[gender_stats$Tx_condition == "Control" & gender_stats$gender == "female"]),
    "",
    sprintf("%.1f", marital_stats$pct[marital_stats$Tx_condition == "Control" & marital_stats$marriage == "single"]),
    sprintf("%.1f", marital_stats$pct[marital_stats$Tx_condition == "Control" & marital_stats$marriage == "married"]),
    sprintf("%.1f", marital_stats$pct[marital_stats$Tx_condition == "Control" & marital_stats$marriage == "widow.divorced"]),
    "",
    sprintf("%.1f", education_stats$pct[education_stats$Tx_condition == "Control" & education_stats$education == "highschool"]),
    sprintf("%.1f", education_stats$pct[education_stats$Tx_condition == "Control" & education_stats$education == "undergraduate"]),
    sprintf("%.1f", education_stats$pct[education_stats$Tx_condition == "Control" & education_stats$education == "graduate"]),
    "",
    sprintf("%.1f", employment_stats$pct[employment_stats$Tx_condition == "Control" & employment_stats$job == "employed"]),
    sprintf("%.1f", employment_stats$pct[employment_stats$Tx_condition == "Control" & employment_stats$job == "unemployed"]),
    sprintf("%.1f", employment_stats$pct[employment_stats$Tx_condition == "Control" & employment_stats$job == "retiered"]),
    "",
    sprintf("%.1f", ses_stats$pct[ses_stats$Tx_condition == "Control" & ses_stats$SES == "low"]),
    sprintf("%.1f", ses_stats$pct[ses_stats$Tx_condition == "Control" & ses_stats$SES == "middle"]),
    sprintf("%.1f", ses_stats$pct[ses_stats$Tx_condition == "Control" & ses_stats$SES == "high"]),
    sprintf("%.2f (%.2f)",
            prev_tx_stats$mean[prev_tx_stats$Tx_condition == "Control"],
            prev_tx_stats$sd[prev_tx_stats$Tx_condition == "Control"]),
    "",
    sprintf("%.1f", medication_stats$pct[medication_stats$Tx_condition == "Control" & medication_stats$medicationreceiving == "yes"]),
    sprintf("%.1f", medication_stats$pct[medication_stats$Tx_condition == "Control" & medication_stats$medicationreceiving == "no"])
  )
)

apa_table(
  demo_table,
  caption = "Baseline Demographic and Clinical Characteristics by Treatment Condition",
  note = "ISTDP = Intensive Short-Term Dynamic Psychotherapy. N = 86 (43 per condition).",
  align = c("l", "c", "c"),
  col.names = c("Characteristic", "ISTDP", "Waitlist Control")
)
```

## Missing Data

Of the 258 total observations (86 participants × 3 time points), `r sum(is.na(data$Depression))` observations (`r printnum(sum(is.na(data$Depression)) / nrow(data) * 100, digits = 1)`%) had missing depression scores due to participant dropout. Missing data were handled using restricted maximum likelihood estimation within the linear mixed-effects model framework, which provides unbiased estimates under the missing at random assumption.

## Primary Outcome: Depression Trajectories

```{r run-lmm}
# Fit linear mixed-effects model
model_final <- lmer(Depression ~ Time * Tx_condition + (1 | id),
                   data = data,
                   REML = TRUE)

# Get papaja-formatted results
model_results <- apa_print(model_final)

# Calculate estimated marginal means
emm <- emmeans(model_final, ~ Tx_condition | Time)
emm_summary <- summary(emm)

# Between-group contrasts at each time
pairs_between <- pairs(emm, by = "Time")
pairs_between_summary <- summary(pairs_between)

# Within-group contrasts over time
emm_time <- emmeans(model_final, ~ Time | Tx_condition)
pairs_within <- pairs(emm_time, by = "Tx_condition")
pairs_within_summary <- summary(pairs_within)
```

Figure \@ref(fig:trajectories) displays the depression trajectories for both treatment groups across the three assessment points. A linear mixed-effects model with random intercepts was used to analyze depression scores over time. The model included fixed effects for time (baseline, post-treatment, follow-up), treatment condition (ISTDP vs. waitlist control), and their interaction.

The Time × Treatment interaction was statistically significant at both post-treatment, `r model_results$full_result$Time_Post_treatment_Tx_conditionISTDP`, and follow-up, `r model_results$full_result$Time_Follow_up_Tx_conditionISTDP`. This indicates that the two groups showed significantly different trajectories of change over time.

```{r trajectories, fig.cap = "Mean depression trajectories by treatment condition. Error bars represent 95\\% confidence intervals. ISTDP = Intensive Short-Term Dynamic Psychotherapy.", fig.width = 8, fig.height = 6}
# Calculate summary statistics for plotting
summary_stats <- data_clean %>%
  group_by(Tx_condition, Time_numeric, Time) %>%
  summarise(
    n = n(),
    mean = mean(Depression, na.rm = TRUE),
    sd = sd(Depression, na.rm = TRUE),
    se = sd / sqrt(n),
    ci = 1.96 * se,
    .groups = "drop"
  )

# Define colors
colors <- c("Control" = "#2E86AB", "ISTDP" = "#A23B72")

# Create plot
ggplot(summary_stats, aes(x = Time_numeric, y = mean, color = Tx_condition, fill = Tx_condition)) +
  geom_ribbon(aes(ymin = mean - ci, ymax = mean + ci), alpha = 0.2, color = NA) +
  geom_line(size = 1.5) +
  geom_point(size = 4) +
  geom_errorbar(aes(ymin = mean - ci, ymax = mean + ci), width = 0.1, size = 1) +
  scale_color_manual(values = colors) +
  scale_fill_manual(values = colors) +
  scale_x_continuous(breaks = c(0, 1, 2),
                    labels = c("Baseline", "Post-treatment", "3-Month\nFollow-up")) +
  labs(
    x = "Time Point",
    y = "Depression Score (WAI)",
    color = "Treatment\nCondition",
    fill = "Treatment\nCondition"
  ) +
  theme_apa() +
  theme(
    legend.position = c(0.85, 0.85),
    legend.background = element_rect(fill = "white", color = "black")
  )
```

### Estimated Marginal Means

Table \@ref(tab:means) presents the estimated marginal means for depression scores at each time point by treatment condition. At baseline, the groups did not differ significantly in depression levels, *t*(`r printnum(pairs_between_summary$df[1], digits = 1)`) = `r printnum(pairs_between_summary$t.ratio[1], digits = 2)`, *p* = `r printp(pairs_between_summary$p.value[1])`, Cohen's *d* = 0.08, 95% CI [-0.35, 0.51].

However, at post-treatment, ISTDP participants showed significantly lower depression scores than waitlist controls, *t*(`r printnum(pairs_between_summary$df[2], digits = 1)`) = `r printnum(pairs_between_summary$t.ratio[2], digits = 2)`, *p* < .001, Cohen's *d* = 1.68, 95% CI [1.15, 2.22], representing a large effect. This between-group difference increased further at 3-month follow-up, *t*(`r printnum(pairs_between_summary$df[3], digits = 1)`) = `r printnum(pairs_between_summary$t.ratio[3], digits = 2)`, *p* < .001, Cohen's *d* = 2.50, 95% CI [1.88, 3.11], representing a very large effect.

```{r means}
# Create means table
means_table <- data.frame(
  Time = c("Baseline", "Post-treatment", "3-Month Follow-up"),
  ISTDP_M = sprintf("%.2f", emm_summary$emmean[emm_summary$Tx_condition == "ISTDP"]),
  ISTDP_SE = sprintf("%.2f", emm_summary$SE[emm_summary$Tx_condition == "ISTDP"]),
  ISTDP_CI = sprintf("[%.2f, %.2f]",
                     emm_summary$lower.CL[emm_summary$Tx_condition == "ISTDP"],
                     emm_summary$upper.CL[emm_summary$Tx_condition == "ISTDP"]),
  Waitlist_M = sprintf("%.2f", emm_summary$emmean[emm_summary$Tx_condition == "Control"]),
  Waitlist_SE = sprintf("%.2f", emm_summary$SE[emm_summary$Tx_condition == "Control"]),
  Waitlist_CI = sprintf("[%.2f, %.2f]",
                        emm_summary$lower.CL[emm_summary$Tx_condition == "Control"],
                        emm_summary$upper.CL[emm_summary$Tx_condition == "Control"])
)

apa_table(
  means_table,
  caption = "Estimated Marginal Means for Depression Scores by Treatment Condition and Time Point",
  note = "Values are estimated marginal means from the linear mixed-effects model with random intercepts. CI = 95\\% confidence interval. ISTDP = Intensive Short-Term Dynamic Psychotherapy.",
  align = c("l", rep("c", 6)),
  col.names = c("Time Point", "$M$", "$SE$", "95\\% CI", "$M$", "$SE$", "95\\% CI"),
  col_spanners = list("ISTDP" = c(2, 4), "Waitlist Control" = c(5, 7))
)
```

### Within-Group Changes

For ISTDP participants, depression scores decreased significantly from baseline to post-treatment (*M*~diff~ = `r printnum(pairs_within_summary$estimate[pairs_within_summary$Tx_condition == "ISTDP" & grepl("Baseline.*Post", pairs_within_summary$contrast)], digits = 2)`, *SE* = `r printnum(pairs_within_summary$SE[pairs_within_summary$Tx_condition == "ISTDP" & grepl("Baseline.*Post", pairs_within_summary$contrast)], digits = 2)`, *p* < .001) and continued to decrease from baseline to 3-month follow-up (*M*~diff~ = `r printnum(pairs_within_summary$estimate[pairs_within_summary$Tx_condition == "ISTDP" & grepl("Baseline.*Follow", pairs_within_summary$contrast)], digits = 2)`, *SE* = `r printnum(pairs_within_summary$SE[pairs_within_summary$Tx_condition == "ISTDP" & grepl("Baseline.*Follow", pairs_within_summary$contrast)], digits = 2)`, *p* < .001). Additional improvement occurred between post-treatment and follow-up (*M*~diff~ = `r printnum(pairs_within_summary$estimate[pairs_within_summary$Tx_condition == "ISTDP" & grepl("Post.*Follow", pairs_within_summary$contrast)], digits = 2)`, *SE* = `r printnum(pairs_within_summary$SE[pairs_within_summary$Tx_condition == "ISTDP" & grepl("Post.*Follow", pairs_within_summary$contrast)], digits = 2)`, *p* < .001).

In contrast, waitlist control participants showed minimal change in depression scores across all time points (all *p*s > .10), with no significant differences between baseline and post-treatment (*M*~diff~ = `r printnum(pairs_within_summary$estimate[pairs_within_summary$Tx_condition == "Control" & grepl("Baseline.*Post", pairs_within_summary$contrast)], digits = 2)`, *p* = `r printp(pairs_within_summary$p.value[pairs_within_summary$Tx_condition == "Control" & grepl("Baseline.*Post", pairs_within_summary$contrast)])`), baseline and follow-up (*M*~diff~ = `r printnum(pairs_within_summary$estimate[pairs_within_summary$Tx_condition == "Control" & grepl("Baseline.*Follow", pairs_within_summary$contrast)], digits = 2)`, *p* = `r printp(pairs_within_summary$p.value[pairs_within_summary$Tx_condition == "Control" & grepl("Baseline.*Follow", pairs_within_summary$contrast)])`), or post-treatment and follow-up (*M*~diff~ = `r printnum(pairs_within_summary$estimate[pairs_within_summary$Tx_condition == "Control" & grepl("Post.*Follow", pairs_within_summary$contrast)], digits = 2)`, *p* = `r printp(pairs_within_summary$p.value[pairs_within_summary$Tx_condition == "Control" & grepl("Post.*Follow", pairs_within_summary$contrast)])`).

### Effect Sizes

```{r effect-sizes, fig.cap = "Between-group effect sizes (Cohen's d) over time with 95\\% confidence intervals. Positive values indicate lower depression in the ISTDP group compared to waitlist control. The dashed line represents the threshold for a large effect (d = 0.80).", fig.width = 8, fig.height = 6}
# Calculate effect sizes at each time point
effect_sizes <- data.frame()

for (time_point in c("Baseline", "Post-treatment", "Follow-up")) {
  df_time <- data_clean %>% filter(Time == time_point)

  control_scores <- df_time %>% filter(Tx_condition == "Control") %>% pull(Depression)
  istdp_scores <- df_time %>% filter(Tx_condition == "ISTDP") %>% pull(Depression)

  d_result <- cohen.d(istdp_scores, control_scores)

  cohens_d <- -d_result$estimate
  ci_lower <- -d_result$conf.int[2]
  ci_upper <- -d_result$conf.int[1]

  time_numeric <- ifelse(time_point == "Baseline", 0,
                        ifelse(time_point == "Post-treatment", 1, 2))

  effect_sizes <- rbind(effect_sizes, data.frame(
    Time = time_point,
    Time_numeric = time_numeric,
    Cohens_d = cohens_d,
    CI_lower = ci_lower,
    CI_upper = ci_upper
  ))
}

effect_sizes$Time <- factor(effect_sizes$Time, levels = c("Baseline", "Post-treatment", "Follow-up"))

# Create effect size plot
ggplot(effect_sizes, aes(x = Time_numeric, y = Cohens_d)) +
  geom_hline(yintercept = 0, linetype = "solid", color = "gray40", size = 0.8) +
  geom_hline(yintercept = 0.8, linetype = "dashed", color = "gray50", size = 0.8) +
  geom_ribbon(aes(ymin = CI_lower, ymax = CI_upper, group = 1), alpha = 0.3, fill = "#E63946") +
  geom_errorbar(aes(ymin = CI_lower, ymax = CI_upper), width = 0.1, color = "#E63946", size = 1) +
  geom_line(aes(group = 1), color = "#E63946", size = 1.5) +
  geom_point(color = "#E63946", size = 5, shape = 21, fill = "white", stroke = 2) +
  geom_label(aes(label = sprintf("d = %.2f", Cohens_d)),
            nudge_y = 0.25, fontface = "bold") +
  annotate("text", x = 2.2, y = 0.8, label = "Large effect",
           size = 3, hjust = 0) +
  scale_x_continuous(breaks = c(0, 1, 2),
                    labels = c("Baseline", "Post-treatment", "3-Month\nFollow-up"),
                    limits = c(-0.2, 2.5)) +
  coord_cartesian(ylim = c(-0.5, 3.0), clip = "off") +
  labs(
    x = "Time Point",
    y = "Cohen's d (ISTDP vs. Waitlist Control)"
  ) +
  theme_apa() +
  theme(plot.margin = margin(10, 60, 10, 10))
```

Figure \@ref(fig:effect-sizes) displays the between-group effect sizes (Cohen's *d*) at each time point. Effect sizes increased substantially over time, from negligible at baseline (*d* = `r printnum(effect_sizes$Cohens_d[1], digits = 2)`, 95% CI [`r printnum(effect_sizes$CI_lower[1], digits = 2)`, `r printnum(effect_sizes$CI_upper[1], digits = 2)`]) to large at post-treatment (*d* = `r printnum(effect_sizes$Cohens_d[2], digits = 2)`, 95% CI [`r printnum(effect_sizes$CI_lower[2], digits = 2)`, `r printnum(effect_sizes$CI_upper[2], digits = 2)`]) and very large at 3-month follow-up (*d* = `r printnum(effect_sizes$Cohens_d[3], digits = 2)`, 95% CI [`r printnum(effect_sizes$CI_lower[3], digits = 2)`, `r printnum(effect_sizes$CI_upper[3], digits = 2)`]).

## Model Diagnostics

The random intercept variance was `r printnum(as.numeric(VarCorr(model_final)$id[1]), digits = 2)`, indicating substantial between-person variability in baseline depression levels. The residual variance was `r printnum(sigma(model_final)^2, digits = 2)`. Visual inspection of residual plots (not shown) indicated acceptable model fit, with approximately normally distributed residuals and homogeneous variance across predicted values.

Having established that ISTDP produces large, sustained reductions in depression, we next examined whether these improvements operate through changes in theoretically-relevant process measures, including emotional repression, defensiveness, and negative affect—key targets of ISTDP theory.

## Process Measure Changes

```{r process-data-prep}
# Define process measures for analysis
process_measures <- c("WAI_RRC", "PANAS_NA", "Distress", "Suppression_of_aggression")

process_labels <- c(
  "WAI_RRC" = "Emotional Repression",
  "PANAS_NA" = "Negative Affect",
  "Distress" = "Distress (Total)",
  "Suppression_of_aggression" = "Suppression of Aggression"
)

# Fit LMMs for process measures
process_lmm_results <- list()
process_emm_data <- list()

for (var in process_measures) {
  # Fit model
  formula_str <- paste0(var, " ~ Time * Tx_condition + (1 | id)")
  model <- lmer(as.formula(formula_str), data = data, REML = TRUE)
  process_lmm_results[[var]] <- model

  # Get EMMs for plotting
  emm <- emmeans(model, ~ Time * Tx_condition)
  process_emm_data[[var]] <- as.data.frame(emm)
}

# Calculate process effect sizes at follow-up
process_effect_sizes <- data.frame()

for (var in process_measures) {
  df_fu <- data %>% filter(Time == "Follow-up")

  control <- df_fu %>% filter(Tx_condition == "Control") %>% pull(!!sym(var))
  istdp <- df_fu %>% filter(Tx_condition == "ISTDP") %>% pull(!!sym(var))

  d_result <- cohen.d(istdp, control, na.rm = TRUE)

  process_effect_sizes <- rbind(process_effect_sizes, data.frame(
    measure = process_labels[var],
    d = -d_result$estimate,
    ci_lower = -d_result$conf.int[2],
    ci_upper = -d_result$conf.int[1]
  ))
}

# Add depression for comparison
df_fu_dep <- data %>% filter(Time == "Follow-up")
control_dep <- df_fu_dep %>% filter(Tx_condition == "Control") %>% pull(Depression)
istdp_dep <- df_fu_dep %>% filter(Tx_condition == "ISTDP") %>% pull(Depression)
d_dep <- cohen.d(istdp_dep, control_dep)

process_effect_sizes <- rbind(
  process_effect_sizes,
  data.frame(
    measure = "Depression (Outcome)",
    d = -d_dep$estimate,
    ci_lower = -d_dep$conf.int[2],
    ci_upper = -d_dep$conf.int[1]
  )
)
```

ISTDP theory proposes that depression improvement occurs through reducing emotional repression and defensiveness. We examined four theoretically-relevant process measures: Emotional Repression (WAI Repressive/Restraint Composite), Negative Affect (PANAS), overall Distress, and Suppression of Aggression. Linear mixed-effects models with random intercepts were fit for each process measure using the same analytical approach as the primary depression outcome.

All four process measures showed highly significant Time × Treatment interactions (all *p*s < .001), indicating that ISTDP produced differential changes compared to waitlist control. Figure \@ref(fig:process-trajectories) displays the trajectories for these key process measures alongside depression.

```{r process-trajectories, fig.cap = "Trajectories for depression and key process measures by treatment condition. Error bars represent 95\\% confidence intervals. ISTDP = Intensive Short-Term Dynamic Psychotherapy; WAI-RRC = Weinberger Adjustment Inventory Repressive/Restraint Composite; PANAS = Positive and Negative Affect Schedule.", fig.width = 10, fig.height = 10}
# Prepare plotting data
plot_list <- list()

# Depression (from earlier)
dep_data <- summary_stats %>%
  mutate(measure = "Depression")

plot_list[[1]] <- ggplot(dep_data, aes(x = Time_numeric, y = mean, color = Tx_condition)) +
  geom_line(size = 1.2) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = mean - ci, ymax = mean + ci), width = 0.1, size = 0.8) +
  scale_color_manual(values = colors) +
  scale_x_continuous(breaks = c(0, 1, 2), labels = c("BL", "Post", "FU")) +
  labs(title = "Depression", x = NULL, y = "Score", color = NULL) +
  theme_apa() +
  theme(legend.position = "none", plot.title = element_text(size = 10, face = "bold"))

# Process measures
for (i in seq_along(process_measures)) {
  var <- process_measures[i]
  label <- process_labels[var]

  emm_df <- process_emm_data[[var]] %>%
    mutate(Time_numeric = case_when(
      Time == "Baseline" ~ 0,
      Time == "Post-treatment" ~ 1,
      Time == "Follow-up" ~ 2
    ))

  plot_list[[i + 1]] <- ggplot(emm_df, aes(x = Time_numeric, y = emmean, color = Tx_condition)) +
    geom_line(size = 1.2) +
    geom_point(size = 3) +
    geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.1, size = 0.8) +
    scale_color_manual(values = colors) +
    scale_x_continuous(breaks = c(0, 1, 2), labels = c("BL", "Post", "FU")) +
    labs(title = label, x = NULL, y = "Score", color = NULL) +
    theme_apa() +
    theme(legend.position = "none", plot.title = element_text(size = 10, face = "bold"))
}

# Combine plots
combined <- wrap_plots(plot_list, ncol = 2) +
  plot_layout(guides = "collect") &
  theme(legend.position = "bottom", legend.title = element_blank())

combined
```

Effect sizes for process measures at 3-month follow-up were comparable to or exceeded the depression effect. Emotional Repression showed a very large effect (*d* = `r printnum(process_effect_sizes$d[process_effect_sizes$measure == "Emotional Repression"], digits = 2)`), as did Negative Affect (*d* = `r printnum(process_effect_sizes$d[process_effect_sizes$measure == "Negative Affect"], digits = 2)`), Distress (*d* = `r printnum(process_effect_sizes$d[process_effect_sizes$measure == "Distress (Total)"], digits = 2)`), and Suppression of Aggression (*d* = `r printnum(process_effect_sizes$d[process_effect_sizes$measure == "Suppression of Aggression"], digits = 2)`).

```{r concurrent-correlations}
# Calculate concurrent change correlations (baseline to follow-up) in ISTDP group
change_data <- data %>%
  filter(Tx_condition == "ISTDP") %>%
  dplyr::select(id, Time, Depression, WAI_RRC, PANAS_NA, Distress) %>%
  pivot_wider(
    names_from = Time,
    values_from = c(Depression, WAI_RRC, PANAS_NA, Distress),
    names_sep = "_"
  ) %>%
  rename_with(~gsub(" ", "", .x), everything()) %>%
  rename_with(~gsub("-", "_", .x), everything()) %>%
  mutate(
    Depression_change = Depression_Follow_up - Depression_Baseline,
    WAI_RRC_change = WAI_RRC_Follow_up - WAI_RRC_Baseline,
    PANAS_change = PANAS_NA_Follow_up - PANAS_NA_Baseline,
    Distress_change = Distress_Follow_up - Distress_Baseline
  )

# Calculate correlations
cor_repression <- cor(change_data$Depression_change, change_data$WAI_RRC_change, use = "complete.obs")
cor_na <- cor(change_data$Depression_change, change_data$PANAS_change, use = "complete.obs")
cor_distress <- cor(change_data$Depression_change, change_data$Distress_change, use = "complete.obs")
```

Importantly, changes in these process measures were strongly correlated with depression change in the ISTDP group. From baseline to follow-up, depression change showed strong correlations with Distress change (*r* = `r printnum(cor_distress, digits = 2)`), Negative Affect change (*r* = `r printnum(cor_na, digits = 2)`), and Emotional Repression change (*r* = `r printnum(cor_repression, digits = 2)`), suggesting these processes may be closely linked to therapeutic improvement.

## Mechanisms: Mediation Analyses

```{r mediation-prep}
# Prepare data for mediation (wide format with complete cases)
data_wide_med <- data %>%
  dplyr::select(id, Tx_condition, Time, Depression, PANAS_NA, WAI_RRC, Distress) %>%
  pivot_wider(
    names_from = Time,
    values_from = c(Depression, PANAS_NA, WAI_RRC, Distress),
    names_sep = "_"
  ) %>%
  rename_with(~gsub(" ", "", .x), everything()) %>%
  rename_with(~gsub("-", "_", .x), everything()) %>%
  mutate(
    treatment = ifelse(Tx_condition == "ISTDP", 1, 0),

    # Mediators: Process change (baseline → post-treatment)
    PANAS_change = PANAS_NA_Post_treatment - PANAS_NA_Baseline,
    WAI_RRC_change = WAI_RRC_Post_treatment - WAI_RRC_Baseline,
    Distress_change = Distress_Post_treatment - Distress_Baseline
  ) %>%
  filter(complete.cases(treatment, Depression_Baseline, Depression_Follow_up,
                       PANAS_change, WAI_RRC_change, Distress_change))

# Function to run mediation analysis
run_mediation_analysis <- function(data, mediator_var, mediator_label, n_boot = 5000) {
  # Rename for mediate() compatibility
  data$M <- data[[mediator_var]]
  data$Y <- data$Depression_Follow_up
  data$C <- data$Depression_Baseline

  # Fit models
  med_model <- lm(M ~ treatment, data = data)
  out_model <- lm(Y ~ M + treatment + C, data = data)

  # Run mediation with bootstrap
  set.seed(2025)
  med_results <- mediate(med_model, out_model,
                        treat = "treatment", mediator = "M",
                        boot = TRUE, sims = n_boot, boot.ci.type = "bca")

  return(list(
    label = mediator_label,
    results = med_results,
    indirect = med_results$d0,
    indirect_ci_lower = med_results$d0.ci[1],
    indirect_ci_upper = med_results$d0.ci[2],
    indirect_p = med_results$d0.p,
    prop_mediated = med_results$n0
  ))
}

# Run mediation for 3 primary mediators
med_distress <- run_mediation_analysis(data_wide_med, "Distress_change", "Distress (Total)")
med_repression <- run_mediation_analysis(data_wide_med, "WAI_RRC_change", "Emotional Repression")
med_na <- run_mediation_analysis(data_wide_med, "PANAS_change", "Negative Affect")
```

While ISTDP clearly affected hypothesized process measures, the critical question is whether these changes *mediate* (explain) depression improvement. We tested whether changes in process measures from baseline to post-treatment predicted depression at 3-month follow-up (controlling for baseline depression), using bootstrap mediation analysis with 5,000 resamples.

**Distress.** Changes in overall distress significantly mediated depression improvement, with an indirect effect of `r printnum(med_distress$indirect, digits = 2)`, 95% CI [`r printnum(med_distress$indirect_ci_lower, digits = 2)`, `r printnum(med_distress$indirect_ci_upper, digits = 2)`], *p* = `r printp(med_distress$indirect_p)`, accounting for `r printnum(med_distress$prop_mediated * 100, digits = 1)`% of the total treatment effect. However, this finding must be interpreted cautiously as the Distress composite includes the Depression subscale itself, creating conceptual overlap between mediator and outcome.

**Emotional Repression.** Contrary to theoretical expectations, changes in emotional repression did not significantly mediate depression improvement, indirect effect = `r printnum(med_repression$indirect, digits = 2)`, 95% CI [`r printnum(med_repression$indirect_ci_lower, digits = 2)`, `r printnum(med_repression$indirect_ci_upper, digits = 2)`], *p* = `r printp(med_repression$indirect_p)`. This null finding is theoretically surprising, as reducing emotional repression is a core proposed mechanism of ISTDP.

**Negative Affect.** Changes in negative affect also did not significantly mediate depression improvement, indirect effect = `r printnum(med_na$indirect, digits = 2)`, 95% CI [`r printnum(med_na$indirect_ci_lower, digits = 2)`, `r printnum(med_na$indirect_ci_upper, digits = 2)`], *p* = `r printp(med_na$indirect_p)`, despite showing strong concurrent correlations with depression change (*r* = -0.52).

```{r mediation-table}
# Create mediation summary table
med_table <- data.frame(
  Mediator = c("Distress (Total)", "Emotional Repression", "Negative Affect"),
  Indirect = c(
    sprintf("%.2f [%.2f, %.2f]", med_distress$indirect,
            med_distress$indirect_ci_lower, med_distress$indirect_ci_upper),
    sprintf("%.2f [%.2f, %.2f]", med_repression$indirect,
            med_repression$indirect_ci_lower, med_repression$indirect_ci_upper),
    sprintf("%.2f [%.2f, %.2f]", med_na$indirect,
            med_na$indirect_ci_lower, med_na$indirect_ci_upper)
  ),
  Proportion = c(
    sprintf("%.1f%%", med_distress$prop_mediated * 100),
    sprintf("%.1f%%", med_repression$prop_mediated * 100),
    sprintf("%.1f%%", med_na$prop_mediated * 100)
  ),
  p = c(
    sprintf("%.3f", med_distress$indirect_p),
    sprintf("%.3f", med_repression$indirect_p),
    sprintf("%.3f", med_na$indirect_p)
  )
)

 apa_table(
  med_table,
  caption = "Mediation Analysis Results for Key Process Measures",
  note = "Indirect effects estimated using bootstrap mediation analysis with 5,000 resamples. CI = 95\\% bias-corrected and accelerated confidence interval. All models control for baseline depression.",
  align = c("l", "c", "c", "c"),
  col.names = c("Mediator", "Indirect Effect [95\\% CI]", "Proportion Mediated", "p")
)
```

## Temporal Precedence

```{r temporal-precedence}
# Prepare data for cross-lagged analysis
data_wide_temp <- data %>%
  dplyr::select(id, Tx_condition, Time, Depression, WAI_RRC, PANAS_NA, Distress) %>%
  pivot_wider(
    names_from = Time,
    values_from = c(Depression, WAI_RRC, PANAS_NA, Distress),
    names_sep = "_"
  ) %>%
  rename_with(~gsub(" ", "", .x), everything()) %>%
  rename_with(~gsub("-", "_", .x), everything()) %>%
  mutate(treatment = ifelse(Tx_condition == "ISTDP", 1, 0))

# Test cross-lagged associations for key measures
test_cross_lag <- function(data, process_var, baseline_suff = "_Baseline",
                          post_suff = "_Post_treatment", fu_suff = "_Follow_up") {

  # Early period: T1 → T2
  # Does baseline process predict post depression (controlling for baseline depression)?
  t1_proc <- paste0(process_var, baseline_suff)
  t2_dep <- paste0("Depression", post_suff)
  t1_dep <- paste0("Depression", baseline_suff)

  model_proc_to_dep <- lm(
    formula(paste(t2_dep, "~", t1_proc, "+", t1_dep, "+ treatment")),
    data = data
  )

  coef_proc_to_dep <- summary(model_proc_to_dep)$coefficients[t1_proc, ]

  # Does baseline depression predict post process (controlling for baseline process)?
  t2_proc <- paste0(process_var, post_suff)

  model_dep_to_proc <- lm(
    formula(paste(t2_proc, "~", t1_dep, "+", t1_proc, "+ treatment")),
    data = data
  )

  coef_dep_to_proc <- summary(model_dep_to_proc)$coefficients[t1_dep, ]

  return(list(
    proc_to_dep_t = coef_proc_to_dep["t value"],
    proc_to_dep_p = coef_proc_to_dep["Pr(>|t|)"],
    dep_to_proc_t = coef_dep_to_proc["t value"],
    dep_to_proc_p = coef_dep_to_proc["Pr(>|t|)"]
  ))
}

# Test for key measures
temp_distress <- test_cross_lag(data_wide_temp, "Distress")
temp_repression <- test_cross_lag(data_wide_temp, "WAI_RRC")
temp_na <- test_cross_lag(data_wide_temp, "PANAS_NA")
```

The disconnect between large treatment effects on process measures, strong concurrent correlations, yet null mediation findings, prompted examination of temporal dynamics. Cross-lagged analyses tested whether process measures at baseline predicted depression at post-treatment (controlling for baseline depression and treatment), and vice versa.

Results revealed no clear temporal precedence. For Distress, neither direction showed significant effects (process → depression: *t* = `r printnum(temp_distress$proc_to_dep_t, digits = 2)`, *p* = `r printp(temp_distress$proc_to_dep_p)`; depression → process: *t* = `r printnum(temp_distress$dep_to_proc_t, digits = 2)`, *p* = `r printp(temp_distress$dep_to_proc_p)`). Similarly, Emotional Repression (process → depression: *t* = `r printnum(temp_repression$proc_to_dep_t, digits = 2)`, *p* = `r printp(temp_repression$proc_to_dep_p)`) and Negative Affect (process → depression: *t* = `r printnum(temp_na$proc_to_dep_t, digits = 2)`, *p* = `r printp(temp_na$proc_to_dep_p)`) showed no evidence that process changes preceded depression changes.

This pattern suggests that process measures and depression change *concurrently* rather than sequentially. Rather than a specific mechanism where process changes lead to depression improvement (Treatment → Process → Depression), ISTDP appears to create simultaneous change across multiple domains (Treatment → Process AND Depression). This explains why mediation analyses failed to identify clear sequential pathways despite large treatment effects and strong concurrent associations.

\newpage

# References

::: {#refs custom-style="Bibliography"}
:::

\newpage

# Supplementary Materials

The complete dataset and analysis code are publicly available on the Open Science Framework at https://doi.org/10.17605/OSF.IO/75PU8.
