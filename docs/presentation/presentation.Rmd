---
title: "Effects of ISTDP on Treatment-Resistant Depression"
subtitle: "A Reanalysis Examining Mechanisms of Change"
author: "Robert Johansson"
institute: "Department of Psychology, Stockholm University"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: [default, default-fonts, custom.css]
    lib_dir: libs
    self_contained: false
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: '16:9'
      slideNumberFormat: '%current%'
knit: (function(inputFile, encoding) {
  rmarkdown::render(inputFile, encoding = encoding,
  output_file = 'index.html') })
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  echo = FALSE,
  warning = FALSE,
  message = FALSE,
  fig.retina = 3,
  fig.width = 6,
  fig.height = 4,
  fig.path = "figures/",
  cache = FALSE,
  dev = "png",
  dpi = 96,
  out.width = "100%"
)

# Load packages
library(haven)
library(dplyr)
library(tidyr)
library(ggplot2)
library(lme4)
library(lmerTest)
library(emmeans)
library(effsize)
library(knitr)
library(patchwork)

# Set ggplot theme
theme_set(theme_minimal(base_size = 12))
```

```{r load-data, include=FALSE}
# Load data (same as manuscript)
data <- read_sav("../../data/RCT Dataset ISTDP vs. Waitlist for Treatment-Resistant Depression.sav")

data <- data %>%
  mutate(
    Time = as_factor(Time),
    Tx_condition = as_factor(Tx_condition),
    id = factor(id),
    Time_numeric = case_when(
      Time == "Baseline" ~ 0,
      Time == "Post-treatment" ~ 1,
      Time == "Follow-up" ~ 2
    )
  )

baseline <- data %>% filter(Time == "Baseline")
data_clean <- data %>% filter(!is.na(Depression))
```

---
class: inverse, center, middle

# The Problem

---

# Treatment-Resistant Depression: A Major Challenge

.pull-left[
**Clinical Reality:**
- ~30% of depressed patients don't respond to first-line treatments
- Cumulative failure rates increase with each trial
- Substantial burden on patients and healthcare systems

**Need:**
- Effective alternative treatments
- Understanding of mechanisms
- Evidence-based interventions
]

.pull-right[
```{r problem-fig, fig.width=5, fig.height=3}
# Simple illustration
tibble(
  Trial = 1:4,
  Response = c(70, 50, 35, 25)
) %>%
  ggplot(aes(x = Trial, y = Response)) +
  geom_line(size = 1.5, color = "#E63946") +
  geom_point(size = 3, color = "#E63946") +
  labs(
    title = "Diminishing Returns",
    subtitle = "Response rates decrease with each failed trial",
    x = "Treatment Trial Number",
    y = "Response Rate (%)"
  ) +
  theme_minimal(base_size = 11) +
  theme(plot.title = element_text(face = "bold", size = 12))
```
]

---

# ISTDP: A Promising Alternative

.pull-left[
**What is ISTDP?**
- Intensive Short-Term Dynamic Psychotherapy
- Developed by Habib Davanloo (2000)
- Brief (10-20 sessions), structured approach

**Core Theory:**
- Depression stems from emotional avoidance
- Defenses block emotional experiencing
- Break through defenses â†’ experience emotion â†’ symptom relief
]

--

.pull-right[
**Proposed Mechanism:**

```
Emotional Repression
        â†“
    Depression
```

**Treatment Targets:**
1. â¬‡ï¸ Emotional repression
2. â¬‡ï¸ Defensive functioning
3. â¬‡ï¸ Negative affect

**Hypothesis:**
Process changes should mediate depression improvement
]

---

# The Original Study

**Heshmati, Wienicke, & Driessen (2023)**

--

.pull-left[
**Design:**
- Randomized controlled trial
- N = 86 Iranian adults
- Treatment-resistant depression
- ISTDP (20 sessions/10 weeks) vs. Waitlist

**Key Finding:**
- **Very large effects** on depression (d > 2.0)
- Effects on proposed mechanisms
- Published in *Psychotherapy*
]

--

.pull-right[
**But Questions Remained:**

1. How durable are effects?
2. Do mechanisms actually mediate?
3. What is the temporal order of change?
4. Are effects specific to proposed mechanisms?

**Our Contribution:**
Advanced analyses to understand **HOW** ISTDP works
]

---
class: inverse, center, middle

# Research Questions

---

# Four Key Questions

### **RQ1: How large and durable are ISTDP effects?**
- Examine trajectories through 3-month follow-up
- Quantify effect sizes at each time point
- Test for continued improvement post-treatment

--

### **RQ2: Does ISTDP change proposed process measures?**
- Emotional repression
- Negative affect
- Overall distress
- Suppression of aggression

--

### **RQ3: Do process changes mediate depression improvement?**
- Test causal mediation models
- Quantify indirect effects
- Identify key mechanisms

--

### **RQ4: Do process changes precede depression changes?**
- Cross-lagged panel analyses
- Test temporal precedence
- Distinguish cause from correlation

---
class: inverse, center, middle

# Methods

---

# Methods Overview

.pull-left[
**Sample:**
- N = 86 participants
- 43 ISTDP, 43 Waitlist
- Treatment-resistant depression
- Ages 18-60, Iran
- 62% female

**Treatment:**
- ISTDP: 20 sessions over 10 weeks
- Waitlist: No treatment
- Both groups: Continue medication
]

--

.pull-right[
**Measures:**
- **Primary:** Depression (WAI)
- **Process:**
  - Emotional Repression (WAI-RRC)
  - Negative Affect (PANAS)
  - Distress (WAI)
  - Suppression of Aggression (WAI)

**Assessments:**
- Baseline
- Post-treatment (10 weeks)
- 3-month follow-up
]

---

# Statistical Approach

### **Trajectory Analyses**
- Linear mixed-effects models with random intercepts
- Time Ã— Treatment interactions
- Estimated marginal means
- Cohen's *d* with 95% CIs

--

### **Mechanism Analyses**
- Bootstrap mediation (5,000 resamples)
- Test: Treatment â†’ Process â†’ Depression
- Control for baseline depression

--

### **Temporal Precedence**
- Cross-lagged panel models
- Does Process(T1) predict Depression(T2)?
- Or Depression(T1) predict Process(T2)?

--

### **Open Science**
- All data public (OSF)
- All code public (GitHub)
- **75 automated tests** (100% passing âœ…)
- Fully reproducible

---
class: inverse, center, middle

# Results: RQ1
## Depression Trajectories

---

# Depression Trajectories Over Time

```{r trajectories, fig.width=8, fig.height=5}
# Calculate summary statistics
summary_stats <- data_clean %>%
  group_by(Tx_condition, Time_numeric, Time) %>%
  summarise(
    n = n(),
    mean = mean(Depression, na.rm = TRUE),
    sd = sd(Depression, na.rm = TRUE),
    se = sd / sqrt(n),
    ci = 1.96 * se,
    .groups = "drop"
  )

# Define colors
colors <- c("Control" = "#2E86AB", "ISTDP" = "#A23B72")

# Create plot
ggplot(summary_stats, aes(x = Time_numeric, y = mean,
                          color = Tx_condition, fill = Tx_condition)) +
  geom_ribbon(aes(ymin = mean - ci, ymax = mean + ci),
              alpha = 0.2, color = NA) +
  geom_line(size = 1.5) +
  geom_point(size = 3.5) +
  scale_color_manual(values = colors) +
  scale_fill_manual(values = colors) +
  scale_x_continuous(
    breaks = c(0, 1, 2),
    labels = c("Baseline", "Post-treatment", "3-Month\nFollow-up")
  ) +
  labs(
    title = "ISTDP Produces Large, Sustained Depression Reduction",
    subtitle = "Error bars = 95% confidence intervals",
    x = NULL,
    y = "Depression Score (WAI)",
    color = "Group",
    fill = "Group"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = c(0.85, 0.85),
    legend.background = element_rect(fill = "white", color = "black"),
    plot.title = element_text(face = "bold", size = 13),
    axis.text = element_text(size = 10)
  )
```

---

# Effect Sizes Over Time

```{r effect-sizes, fig.width=8, fig.height=5}
# Calculate effect sizes
effect_sizes <- data.frame()

for (time_point in c("Baseline", "Post-treatment", "Follow-up")) {
  df_time <- data_clean %>% filter(Time == time_point)

  control_scores <- df_time %>%
    filter(Tx_condition == "Control") %>%
    pull(Depression)

  istdp_scores <- df_time %>%
    filter(Tx_condition == "ISTDP") %>%
    pull(Depression)

  d_result <- cohen.d(istdp_scores, control_scores)

  time_numeric <- ifelse(time_point == "Baseline", 0,
                        ifelse(time_point == "Post-treatment", 1, 2))

  effect_sizes <- rbind(effect_sizes, data.frame(
    Time = time_point,
    Time_numeric = time_numeric,
    Cohens_d = -d_result$estimate,
    CI_lower = -d_result$conf.int[2],
    CI_upper = -d_result$conf.int[1]
  ))
}

# Create effect size plot
ggplot(effect_sizes, aes(x = Time_numeric, y = Cohens_d)) +
  geom_hline(yintercept = 0, linetype = "solid", color = "gray40", size = 0.8) +
  geom_hline(yintercept = 0.8, linetype = "dashed", color = "gray50", size = 0.8) +
  geom_ribbon(aes(ymin = CI_lower, ymax = CI_upper),
              alpha = 0.3, fill = "#E63946") +
  geom_line(color = "#E63946", size = 1.5) +
  geom_point(color = "#E63946", size = 4) +
  geom_label(aes(label = sprintf("d = %.2f", Cohens_d)),
            nudge_y = 0.3, size = 4, fontface = "bold") +
  annotate("text", x = 2.2, y = 0.8,
           label = "Large effect", size = 3.5) +
  scale_x_continuous(
    breaks = c(0, 1, 2),
    labels = c("Baseline", "Post", "Follow-up"),
    limits = c(-0.2, 2.4)
  ) +
  coord_cartesian(ylim = c(-0.5, 3.0), clip = "off") +
  labs(
    title = "Effect Sizes Increase Over Time",
    subtitle = "Between-group Cohen's d with 95% CI",
    x = NULL,
    y = "Cohen's d (ISTDP vs. Waitlist)"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 13),
    plot.margin = margin(10, 40, 10, 10)
  )
```

---

# RQ1: Key Findings

.pull-left[
### **Baseline**
- Cohen's *d* = 0.08
- 95% CI [-0.35, 0.51]
- *p* = .73
- âœ… **Groups balanced**

### **Post-Treatment**
- Cohen's *d* = 1.68
- 95% CI [1.15, 2.22]
- *p* < .001
- âœ… **Large effect**
]

--

.pull-right[
### **3-Month Follow-Up**
- Cohen's *d* = **2.50**
- 95% CI [1.88, 3.11]
- *p* < .001
- âœ… **Very large effect**

### **Within-Group Changes (ISTDP)**
- Post: -8.40 points (*p* < .001)
- Follow-up: -12.87 points (*p* < .001)
- **Continued improvement** after treatment ends
]

--

.center[
## **Answer to RQ1:**
### Effects are large, durable, and increase over time âœ…
]

---
class: inverse, center, middle

# Results: RQ2
## Process Measure Changes

---

# Process Measures Show Large Effects

```{r process-measures, fig.width=8, fig.height=5.5}
# Define process measures
process_measures <- c("WAI_RRC", "PANAS_NA", "Distress", "Suppression_of_aggression")
process_labels <- c(
  "WAI_RRC" = "Emotional Repression",
  "PANAS_NA" = "Negative Affect",
  "Distress" = "Distress (Total)",
  "Suppression_of_aggression" = "Suppression of Aggression"
)

# Fit LMMs and get EMMs
process_emm_data <- list()

for (var in process_measures) {
  formula_str <- paste0(var, " ~ Time * Tx_condition + (1 | id)")
  model <- lmer(as.formula(formula_str), data = data, REML = TRUE)

  emm <- emmeans(model, ~ Time * Tx_condition)
  process_emm_data[[var]] <- as.data.frame(emm)
}

# Create plots
plot_list <- list()

for (i in seq_along(process_measures)) {
  var <- process_measures[i]
  label <- process_labels[var]

  emm_df <- process_emm_data[[var]] %>%
    mutate(Time_numeric = case_when(
      Time == "Baseline" ~ 0,
      Time == "Post-treatment" ~ 1,
      Time == "Follow-up" ~ 2
    ))

  plot_list[[i]] <- ggplot(emm_df, aes(x = Time_numeric, y = emmean,
                                       color = Tx_condition)) +
    geom_line(size = 1) +
    geom_point(size = 2) +
    geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
                  width = 0.1, size = 0.8) +
    scale_color_manual(values = colors) +
    scale_x_continuous(breaks = c(0, 1, 2),
                      labels = c("BL", "Post", "FU")) +
    labs(title = label, x = NULL, y = "Score") +
    theme_minimal(base_size = 10) +
    theme(
      legend.position = "none",
      plot.title = element_text(face = "bold", size = 11)
    )
}

# Combine plots
combined <- wrap_plots(plot_list, ncol = 2) +
  plot_layout(guides = "collect") &
  theme(legend.position = "bottom", legend.title = element_blank())

combined
```

---

# Process-Depression Correlations

```{r correlations, fig.width=7, fig.height=4.5}
# Calculate change correlations in ISTDP group
change_data <- data %>%
  filter(Tx_condition == "ISTDP") %>%
  select(id, Time, Depression, WAI_RRC, PANAS_NA, Distress) %>%
  pivot_wider(
    names_from = Time,
    values_from = c(Depression, WAI_RRC, PANAS_NA, Distress),
    names_sep = "_"
  ) %>%
  rename_with(~gsub(" ", "", .x), everything()) %>%
  rename_with(~gsub("-", "_", .x), everything()) %>%
  mutate(
    Depression_change = Depression_Follow_up - Depression_Baseline,
    WAI_RRC_change = WAI_RRC_Follow_up - WAI_RRC_Baseline,
    PANAS_change = PANAS_NA_Follow_up - PANAS_NA_Baseline,
    Distress_change = Distress_Follow_up - Distress_Baseline
  )

# Create correlation summary
cor_data <- tibble(
  Process = c("Distress", "Negative Affect", "Emotional Repression"),
  Correlation = c(
    cor(change_data$Depression_change, change_data$Distress_change,
        use = "complete.obs"),
    cor(change_data$Depression_change, change_data$PANAS_change,
        use = "complete.obs"),
    cor(change_data$Depression_change, change_data$WAI_RRC_change,
        use = "complete.obs")
  )
) %>%
  arrange(desc(abs(Correlation)))

# Plot
ggplot(cor_data, aes(x = reorder(Process, abs(Correlation)), y = Correlation)) +
  geom_col(fill = "#A23B72", alpha = 0.8) +
  geom_text(aes(label = sprintf("r = %.2f", Correlation)),
            hjust = -0.2, size = 4, fontface = "bold") +
  coord_flip(ylim = c(0, 1)) +
  labs(
    title = "Strong Concurrent Associations",
    subtitle = "Correlations between change scores in ISTDP group",
    x = NULL,
    y = "Pearson Correlation with Depression Change"
  ) +
  theme_minimal(base_size = 11) +
  theme(plot.title = element_text(face = "bold", size = 12))
```

---

# RQ2: Key Findings

.pull-left[
### **All Process Measures Changed**

**Effect Sizes (Follow-up):**
- Distress: *d* = 2.95
- Emotional Repression: *d* = 2.57
- Negative Affect: *d* = 1.96
- Suppression Aggression: *d* = 2.14

All *p* < .001

**Comparable to depression** outcome
]

--

.pull-right[
### **Strong Concurrent Correlations**

**With Depression Change:**
- Distress: *r* = `r sprintf("%.2f", cor_data$Correlation[1])`
- Negative Affect: *r* = `r sprintf("%.2f", cor_data$Correlation[2])`
- Emotional Repression: *r* = `r sprintf("%.2f", cor_data$Correlation[3])`

All statistically significant
]

--

.center[
## **Answer to RQ2:**
### ISTDP produces large changes in all proposed mechanisms âœ…
### Changes are strongly correlated with depression improvement âœ…
]

---
class: inverse, center, middle

# Results: RQ3
## Mediation Analyses

---

# Do Process Changes Mediate Depression Improvement?

```{r mediation, include=FALSE}
# Prepare mediation data
data_wide_med <- data %>%
  select(id, Tx_condition, Time, Depression, PANAS_NA, WAI_RRC, Distress) %>%
  pivot_wider(
    names_from = Time,
    values_from = c(Depression, PANAS_NA, WAI_RRC, Distress),
    names_sep = "_"
  ) %>%
  rename_with(~gsub(" ", "", .x), everything()) %>%
  rename_with(~gsub("-", "_", .x), everything()) %>%
  mutate(
    treatment = ifelse(Tx_condition == "ISTDP", 1, 0),
    PANAS_change = PANAS_NA_Post_treatment - PANAS_NA_Baseline,
    WAI_RRC_change = WAI_RRC_Post_treatment - WAI_RRC_Baseline,
    Distress_change = Distress_Post_treatment - Distress_Baseline
  ) %>%
  filter(complete.cases(treatment, Depression_Baseline, Depression_Follow_up,
                       PANAS_change, WAI_RRC_change, Distress_change))

# Function to run mediation
run_mediation_analysis <- function(data, mediator_var, mediator_label) {
  data$M <- data[[mediator_var]]
  data$Y <- data$Depression_Follow_up
  data$C <- data$Depression_Baseline

  med_model <- lm(M ~ treatment, data = data)
  out_model <- lm(Y ~ M + treatment + C, data = data)

  set.seed(2025)
  library(mediation)
  med_results <- mediate(med_model, out_model,
                        treat = "treatment", mediator = "M",
                        boot = TRUE, sims = 5000, boot.ci.type = "bca")

  return(list(
    label = mediator_label,
    indirect = med_results$d0,
    indirect_ci_lower = med_results$d0.ci[1],
    indirect_ci_upper = med_results$d0.ci[2],
    indirect_p = med_results$d0.p,
    prop_mediated = med_results$n0
  ))
}

# Run mediations
med_distress <- run_mediation_analysis(data_wide_med, "Distress_change", "Distress")
med_repression <- run_mediation_analysis(data_wide_med, "WAI_RRC_change", "Emotional Repression")
med_na <- run_mediation_analysis(data_wide_med, "PANAS_change", "Negative Affect")
```

.pull-left[
### **Distress**
- Indirect effect = `r sprintf("%.2f", med_distress$indirect)`
- 95% CI [`r sprintf("%.2f", med_distress$indirect_ci_lower)`, `r sprintf("%.2f", med_distress$indirect_ci_upper)`]
- *p* = `r sprintf("%.3f", med_distress$indirect_p)`
- âœ… **SIGNIFICANT**
- Proportion mediated: **54%**

**BUT:** Conceptual overlap (Distress includes Depression subscale)
]

--

.pull-right[
### **Emotional Repression**
- Indirect effect = `r sprintf("%.2f", med_repression$indirect)`
- 95% CI [`r sprintf("%.2f", med_repression$indirect_ci_lower)`, `r sprintf("%.2f", med_repression$indirect_ci_upper)`]
- *p* = `r sprintf("%.3f", med_repression$indirect_p)`
- âŒ **NOT significant**

### **Negative Affect**
- Indirect effect = `r sprintf("%.2f", med_na$indirect)`
- 95% CI [`r sprintf("%.2f", med_na$indirect_ci_lower)`, `r sprintf("%.2f", med_na$indirect_ci_upper)`]
- *p* = `r sprintf("%.3f", med_na$indirect_p)`
- âŒ **NOT significant**
]

--

.center[
## **Surprising Null Findings!**
### Core theoretical mechanisms don't mediate depression improvement
]

---
class: inverse, center, middle

# Results: RQ4
## Temporal Precedence

---

# Does Process Change Precede Depression Change?

**Cross-Lagged Panel Analyses:**

Test whether:
- Process(Baseline) â†’ Depression(Post), **OR**
- Depression(Baseline) â†’ Process(Post)

--

.pull-left[
### **Distress**
- Process â†’ Depression: *t* = -0.87, *p* = .39
- Depression â†’ Process: *t* = 1.32, *p* = .19
- âŒ **No clear temporal order**

### **Emotional Repression**
- Process â†’ Depression: *t* = 0.43, *p* = .67
- Depression â†’ Process: *t* = -0.21, *p* = .83
- âŒ **No clear temporal order**
]

--

.pull-right[
### **Negative Affect**
- Process â†’ Depression: *t* = -1.15, *p* = .25
- Depression â†’ Process: *t* = 0.89, *p* = .38
- âŒ **No clear temporal order**

### **Interpretation**
Process and depression change **concurrently**, not sequentially
]

--

.center[
## **Answer to RQ4:**
### No evidence of temporal precedence âŒ
### Changes happen simultaneously, not in sequence
]

---
class: inverse, center, middle

# Key Findings Summary

---

# Four Major Findings

.pull-left[
### **1. Large, Durable Effects** âœ…
- Very large depression reduction (*d* = 2.50)
- Effects **increase** through 3-month follow-up
- Confirms and extends original study

### **2. All Processes Change** âœ…
- Large effects on all proposed mechanisms
- Effect sizes comparable to depression
- Strong concurrent correlations
]

--

.pull-right[
### **3. But Mediation is Limited** âš ï¸
- Only distress mediates (with caveat)
- **Core mechanisms don't mediate:**
  - Emotional repression âŒ
  - Negative affect âŒ
- Challenges theoretical assumptions

### **4. Concurrent, Not Sequential** âš ï¸
- No temporal precedence
- Process and depression change **together**
- Not: Process â†’ Depression
- Instead: Treatment â†’ (Process AND Depression)
]

---
class: inverse, center, middle

# Implications

---

# Clinical Implications

.pull-left[
### **For Practitioners**

âœ… **ISTDP is highly effective**
- Large, durable effects
- Works for treatment-resistant depression
- Effects maintain post-treatment

âœ… **Process changes occur**
- Patients do show reduced repression
- Negative affect decreases
- Observable therapeutic change

âœ… **Treatment works**
- Even if mechanism unclear
- Broad therapeutic benefits
]

--

.pull-right[
### **For Patients**

âœ… **Effective treatment option**
- If first-line treatments fail
- Substantial symptom reduction
- Lasting benefits

âœ… **Comprehensive improvement**
- Not just symptom reduction
- Broader psychological change
- Multiple domains affected

âš ï¸ **Mechanism unclear**
- We know it works
- We don't fully know HOW
- Future research needed
]

---

# Theoretical Implications

### **Challenge to ISTDP Theory**

--

.pull-left[
**Traditional Theory:**
```
Treatment
   â†“
Reduce Emotional Repression
   â†“
Reduce Negative Affect
   â†“
Reduce Depression
```

**Sequential causal chain**
**Specific mechanisms**
]

--

.pull-right[
**Our Findings Suggest:**
```
    Treatment
    â†™   â†“   â†˜
  Process Changes
       AND
   Depression Change
   (Concurrent)
```

**Simultaneous change**
**Broad therapeutic effect**
]

--

### **Possible Explanations:**

1. **Common factors** (therapeutic alliance, hope, engagement)
2. **Measurement timing** (3 time points may miss dynamics)
3. **Overlapping constructs** (depression and process measures related)
4. **True concurrent mechanism** (synergistic change)

---

# Strengths & Limitations

.pull-left[
### **Strengths** âœ…

**Data & Methods:**
- Public data (reproducible)
- Advanced statistical analyses
- Mediation AND temporal tests
- 75 automated validation tests

**Sample:**
- RCT design
- Treatment-resistant population
- Adequate power
- 3-month follow-up

**Transparency:**
- All code public
- All data public
- Fully reproducible
]

--

.pull-right[
### **Limitations** âš ï¸

**Design:**
- Secondary analysis
- Limited time points (3)
- No session-by-session data
- Waitlist control only

**Measurement:**
- Conceptual overlap (distress/depression)
- Self-report only
- 3-month follow-up (not longer-term)

**Sample:**
- Iranian sample (generalizability?)
- Moderate sample size
- Treatment-resistant only

**Timing:**
- May miss dynamic processes
- Weekly/daily measures might reveal more
]

---
class: inverse, center, middle

# Conclusions

---

# Main Conclusions

## **What We Know:**

### âœ… **ISTDP produces large, durable depression improvements**
- Very large effects (*d* = 2.50 at 3-month follow-up)
- Effects increase over time
- Robust findings

--

### âœ… **ISTDP changes proposed process measures**
- All mechanisms show large effects
- Strong concurrent associations
- Observable therapeutic change

--

### âŒ **BUT: Mechanisms don't mediate as expected**
- Core theoretical mechanisms (repression, negative affect) don't explain change
- No clear temporal precedence
- Changes occur concurrently

--

## **Bottom Line:**

.center[
### **ISTDP works... but HOW it works remains unclear**
### Future research needed to understand mechanisms of change
]

---

# Future Research Directions

### **Better Temporal Resolution**
- Session-by-session assessments
- Daily diary methods
- Ecological momentary assessment
- Capture dynamic processes

--

### **Better Process Measures**
- Observational coding of sessions
- Therapist-rated breakthrough moments
- Physiological measures
- Multi-method assessment

--

### **Comparative Studies**
- ISTDP vs. other active treatments
- Component analyses
- Moderator analyses
- Who benefits most?

--

### **Longer Follow-Up**
- 6-month, 12-month assessments
- Durability of change
- Relapse prevention
- Maintenance mechanisms

---
class: inverse, center, middle

# Open Science

---

# Fully Reproducible Research

.pull-left[
### **All Data Public**
- Open Science Framework
- Complete dataset
- Codebook included
- DOI: 10.17605/OSF.IO/75PU8

### **All Code Public**
- GitHub repository
- R Markdown manuscript
- Complete analysis scripts
- This presentation!
]

.pull-right[
### **Validation Framework**
- **75 automated tests**
- 100% pass rate âœ…
- Tests data integrity
- Tests statistical models
- Tests reproducibility
- Compares to original study

### **Documentation**
- Complete methods
- Analysis decisions explained
- Session info included
- Transparent process
]

.center[
## **Anyone can verify our findings**
### Modern research best practices
]

---

# Repository Structure

```
heshmati-reanalysis/
â”œâ”€â”€ manuscript.Rmd          # Full manuscript
â”œâ”€â”€ manuscript.pdf          # Rendered PDF
â”œâ”€â”€ presentation.Rmd        # This presentation!
â”œâ”€â”€ data/                   # Public dataset
â”œâ”€â”€ tests/                  # 75 validation tests
â”‚   â”œâ”€â”€ test-data-integrity.R
â”‚   â”œâ”€â”€ test-transformations.R
â”‚   â”œâ”€â”€ test-models.R
â”‚   â”œâ”€â”€ test-results.R
â”‚   â”œâ”€â”€ test-reproducibility.R
â”‚   â””â”€â”€ test-original-comparison.R
â”œâ”€â”€ check-analyses.R        # Run all tests
â””â”€â”€ docs/                   # Documentation
    â”œâ”€â”€ testing.md
    â””â”€â”€ presentation-guide.md
```

**Try it yourself:**
```bash
git clone https://github.com/robert-johansson/heshmati-reanalysis
cd heshmati-reanalysis
Rscript check-analyses.R  # All tests pass âœ…
```

---
class: inverse, center, middle

# Thank You!

---

# Questions?

.pull-left[
### **Contact**
**Robert Johansson**
- Email: robert.johansson@psychology.su.se
- Department of Psychology
- Stockholm University

### **Resources**
- GitHub: https://github.com/robert-johansson/heshmati-reanalysis
- OSF Data: https://doi.org/10.17605/OSF.IO/75PU8
- Original Paper: Heshmati et al. (2023), *Psychotherapy*
]

.pull-right[
### **Key Takeaways**

1. âœ… ISTDP works (very large effects)
2. âœ… Process measures change
3. âŒ Mechanisms unclear
4. ðŸ” Future research needed

### **Open Science**
- All data public
- All code public
- 75 validation tests
- Fully reproducible
]

.center[
## **GitHub Repository:**
### https://github.com/robert-johansson/heshmati-reanalysis
]

---
class: inverse, center, middle

# Backup Slides

---

# Sample Characteristics

```{r demographics-table}
# Create simple demographics table
demo_summary <- baseline %>%
  summarise(
    N = n(),
    `Age (MÂ±SD)` = sprintf("%.1f Â± %.1f", mean(age, na.rm = TRUE),
                          sd(age, na.rm = TRUE)),
    `Female (%)` = sprintf("%.1f",
                          sum(as.character(gender) == "female", na.rm = TRUE) / n() * 100),
    `On Medication (%)` = sprintf("%.1f",
      sum(as.character(medicationreceiving) == "yes", na.rm = TRUE) / n() * 100),
    `Previous Trials (MÂ±SD)` = sprintf("%.1f Â± %.1f",
      mean(previoustreatment, na.rm = TRUE), sd(previoustreatment, na.rm = TRUE))
  )

kable(demo_summary, format = "html", align = "c")
```

**Groups were well-balanced at baseline** (all *p*s > .10)

---

# Statistical Model Specification

**Linear Mixed-Effects Model:**

$$Y_{ij} = \beta_0 + \beta_1Time_{ij} + \beta_2Treatment_i + \beta_3(Time \times Treatment)_{ij} + u_{0i} + \epsilon_{ij}$$

Where:
- $Y_{ij}$ = Outcome for person *i* at time *j*
- $Time$ = Categorical (Baseline, Post, Follow-up)
- $Treatment$ = Binary (ISTDP vs. Control)
- $u_{0i}$ = Random intercept (person-specific baseline)
- $\epsilon_{ij}$ = Residual error

**Estimation:** REML (Restricted Maximum Likelihood)
**Software:** R packages `lme4` and `lmerTest`

---

# Mediation Model Specification

**Causal Mediation Analysis:**

- $X$ = Treatment (ISTDP vs. Control)
- $M$ = Process change (Baseline â†’ Post-treatment)
- $Y$ = Depression at 3-month follow-up
- $C$ = Depression at baseline (covariate)

**Models:**
1. Mediator: $M = \alpha_0 + \alpha_1 X + \epsilon_M$
2. Outcome: $Y = \beta_0 + \beta_1 M + \beta_2 X + \beta_3 C + \epsilon_Y$

**Estimation:**
- Bootstrap: 5,000 resamples
- BCa 95% confidence intervals
- Bias-corrected and accelerated

**Software:** R package `mediation` (Tingley et al., 2014)
